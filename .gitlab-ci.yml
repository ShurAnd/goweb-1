---
variables:
  IMAGE_TAG: "latest"

stages:
  - build
  - test
  - deploy

image: docker:latest

build-task:
  stage: build
  variables:
    DOCKER_HOST: unix:///var/run/docker.sock
  script:
    - docker build -t $IMAGE_NAME:$IMAGE_TAG .
    - docker login -u $DOCKER_USER -p $DOCKER_PASS
    - docker push $IMAGE_NAME:$IMAGE_TAG
test-task:
  stage: test
  script:
    - echo "test"

deploy-task:
  stage: deploy
  script:
    - ls -la
...
